## 스코프

---

1. 스코프란?
2. 스코프의 종류
3. 스코프 체인
4. 함수 레벨 스코프
5. 렉시컬 스코프

---

### **13.1 스코프란?**

- 스코프 (식별자 유효 범위, JS 엔진이 식별자 검색할 때 사용하는 규칙)

  - 변수 이름 충돌 방지 -> 같은 이름 변수 사용 가능

- var 스코프 vs. const, let 스코프

- 함수의 매개변수 스코프는 함수 몸체 내부로 한정

- 모든 식별자는 자신이 선언된 위치에 의해 다른 코드가 식별자 자신을 참조할 수 있는 스코프가 결정됨

- Lexical(Static) Scope

  - Lexical Environment (코드가 어디서 실행되며 주변에 어떤 코드가 있는지)

  - 코드의 context (문맥)은 렉시컬 환경으로 이루어짐, 이를 구현한 것이 Execution Context

  - 모든 코드는 실행 컨텍스트에서 평가되고 실행됨

- JS 엔진이 스코프를 통해 어떤 변수 참조할 것인지 결정 (identifier resolution)

- JS 엔진은 코드 실행할 때 코드의 context (문맥) 고려

- 식별자 이름이 동일하지만 스코프가 다르면 다른 식별자임

  - 스코프는 네임 스페이스

- 식별자는 어떤 값을 구별할 수 있어야 하므로 unique 해야 함!

  - 식별자는 중복될 수 없음

  - 하나의 값은 유일한 식별자에 name binding (연결)되어야 함! <- 스코프 개념 도입된 이유

  - ex) 여러 디렉토리에 존재하는 동일한 이름의 파일 (디렉토리 개념 <- 스코프 역할)
    <br/>
    <br/>

### **13.2 스코프의 종류**

- 전역과 전역 스코프

  - 전역: 코드의 가장 바깥 영역

  - 전역 변수는 어디서든지 참조 가능

- 지역과 지역 스코프

  - 지역: 함수 몸체 내부

  - 지역 변수는 자신의 지역 스코프와 하위 지역 스코프에서 유효함

  - JS 엔진이 스코프 체인을 통해 참조할 변수 검색 (identifer resolution)
    <br/>
    <br/>

### **13.3 스코프 체인**

- 스코프 체인

  - 스코프가 함수의 중첩에 의해 계층적 구조를 가질 수 있음

  - 스코프 체인은 실행 컨텍스트의 렉시컬 환경을 단방향으로 chaining(연결)한 것

    - 전역 렉시컬 환경은 코드가 로드되면 곧바로 생성되고, 함수 렉시컬 환경은 호출될 때 생성됨

  - 외부 함수의 지역 스코프는 중첩(내부) 함수의 상위 스코프임

  - 모든 스코프는 하나의 계층적 구조로 연결됨 (스코프 체인)

  - 모든 지역 스코프의 최상위 스코프는 전역 스코프

  - 변수 참조 시 JS 엔진은 스코프 체인을 통해 변수 참조하는 코드의 스코프에서 시작하여

    상위 스코프 방향으로 이동하며 선언된 변수 검색 (identifier resolution)

  - 상위 스코프에서 선언한 변수를 하위 스코프에서도 참조 가능

- 스코프 체인에 의한 변수 검색

  - 절대로 하위 스코프로 내려가서 식별자 검색하지 않음

  - 상위 스코프에서 유효한 변수는 하위 스코프에서 자유롭게 참조 가능

  - 하위 스코프에서 유효한 변수는 상위 스코프에서 참조할 수 없음

  - 스코프 체인 -> 상속 관계 유사

- 스코프 체인에 의한 함수 검색

  - JS 엔진에 의해 암묵적으로 모든 함수는 함수 이름과 동일한 이름의 식별자에 할당됨 (함수 선언문의 경우)

  - 스코프: 식별자를 검색하는 규칙 (함수, 변수, 클래스 이름 등 모두 포함)
    <br/>
    <br/>

### **13.4 함수 레벨 스코프**

    - 코드 블록이 아닌 함수에 의해서만 지역 스코프 생성됨

    - var 키워드 선언 변수 -> 오로지 함수의 코드 블록(함수 몸체)만을 지역 스코프로 인정

    - var 키워드 vs. const, let 키워드

      - var 키워드: function level scope

      - const, let 키워드: block level scope

  <br/>
  <br/>

### **13.5 렉시컬 스코프**

    - 함수 상위 스코프 결정

      - JS는 함수를 어디서 정의했는지에 따라 함수 상위 스코프 결정 (함수 호출 방식 아님 - 동적 스코프)

        => 정적/렉시컬 스코프: 함수 정의가 평가되는 시점에 함수 상위 스코프가 정적으로 결정됨

      - 함수를 어디서 정의했는지가 중요함

      - 함수 호출 위치는 상위 스코프에 영향 주지 않음
